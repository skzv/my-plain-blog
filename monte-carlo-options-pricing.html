<!DOCTYPE html> <html lang="en"> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1" /> <meta property="og:image" content="https://blog.skz.dev/assets/img/monte-carlo-stocks/gbm-example.png"> <meta name="twitter:image" content="https://blog.skz.dev/assets/img/monte-carlo-stocks/gbm-example.png"> <meta name="author" content="Sasha Kuznetsov"> <title>Monte Carlo Options Pricing · Sasha Kuznetsov's Blog</title> <meta property="og:title" content="Monte Carlo Options Pricing · Sasha Kuznetsov's Blog"> <meta name="twitter:title" content="Monte Carlo Options Pricing · Sasha Kuznetsov's Blog"> <meta name="description" content="The options casino"> <meta property="og:description" content="The options casino"> <meta name="twitter:description" content="The options casino"> <link rel="icon" href="https://blog.skz.dev/assets/img/favicon.png"> <link rel="apple-touch-icon" href="https://blog.skz.dev/assets/img/favicon.png"> <link rel="stylesheet" href="https://blog.skz.dev/assets/css/core.css"> <link rel="canonical" href="https://blog.skz.dev/monte-carlo-options-pricing"> <link rel="alternate" type="application/atom+xml" title="Sasha Kuznetsov's Blog" href="https://blog.skz.dev/feed.xml" /> <script src="/assets/js/load-mathjax.js" async></script> <meta name="twitter:card" content="summary_large_image"> <meta name="twitter:creator" content="@skzv"> </head> <body> <aside class="logo"> <a href="https://blog.skz.dev/" aria-label="My avatar"> <img src="https://avatars.githubusercontent.com/u/11140296?v=4" alt="Me!" class="logo-avatar"> </a> <span class="logo-prompt code">Back to Index</span> </aside> <div id="content"> <article> <div class="center"> <h1 class="title">Monte Carlo Options Pricing</h1> <time class="code">December 17, 2021</time> </div> <div class="divider"></div> <h4 id="the-options-casino"><em>The options casino</em></h4> <p>Predicting the movement of stock prices is an alluring challenge with the promise of riches. Unfortunately, predicting future stock prices consistently and reliably is generally considered impossible. However, we can use models to make useful predictions, manage risk, and profit <em>probalistically</em>.</p> <h1 id="geometric-brownian-motion">Geometric Brownian Motion</h1> <p>One such commonly used model is geometric Brownian motion (<a href="https://stats.libretexts.org/Bookshelves/Probability_Theory/Probability_Mathematical_Statistics_and_Stochastic_Processes_(Siegrist)/18%3A_Brownian_Motion/18.04%3A_Geometric_Brownian_Motion">1</a>, <a href="http://www.columbia.edu/~ks20/FE-Notes/4700-07-Notes-GBM.pdf">2</a>) - in fact, the famous <a href="https://en.wikipedia.org/wiki/Black%E2%80%93Scholes_model">Black-Scholes options pricing formula</a> assumes this model as well. This has the form</p> <div style="width: 100%; overflow-x: auto;"> $$ \begin{align} S(t) = S(0)\exp{((\mu-\frac{\sigma^2}{2})t + \sigma B(t))} \tag{0} \label{eq:gbm} \end{align} $$ </div> <p>where \(B(t)\) is standard Brownian motion. If we let \(S(0)\) to be the initial stock price, \(\mu\) to be the mean <a href="https://en.wikipedia.org/wiki/Rate_of_return#Logarithmic_or_continuously_compounded_return">compounding return</a>, and \(\sigma\) to be the <a href="https://en.wikipedia.org/wiki/Volatility_(finance)">volatility</a> of a stock, then we can generate very realistic price paths.</p> <div id="plot-0"></div> <p><span class="slider-container"> <span class="slider-label">\(\mu\)</span> <span> <input class="slider" id="mean-slider" type="range" min="-2.5" max="1" value="0" step="0.01" /> </span> <span class="slider-value" id="mean-slider-value">0</span> </span></p> <p><span class="slider-container"> <span class="slider-label">\(\sigma\)</span> <span> <input class="slider" id="sigma-slider" type="range" min="0" max="1" value="0" step="0.01" /> </span> <span class="slider-value" id="sigma-slider-value">0</span> </span></p> <p><button class="regenerate-button" onclick="regenerate0()">Regenerate</button></p> <div style="display:none" id="mean-0">0</div> <div style="display:none" id="sigma-0">0</div> <div style="display:none" id="option-mean-0">0</div> <p>So, what does this mean, and why is this a good model for security prices?</p> <h2 id="logarithmic-returns">Logarithmic Returns</h2> <p>In quantitative finance it is common to deal with continuously compounded returns rather than simple returns. What that means is that instead of examining a simple return between trading periods \(1 + R_t = \frac{S(t)}{S(t-1)}\) we will examine the compounding return \(r_t = \ln{(1 + R_t)} = \ln{\frac{S(t)}{S(t-1))}}\). This has the very nice property that one can recover the price of a stock by simply summing up the logarithmic returns as:</p> <div style="width: 100%; overflow-x: auto;"> $$ \begin{align} S(t) = S(0)\exp{(r_1 + r_2 + ... + r_{t-1})} \tag{1} \label{eq:rr} \end{align} $$ </div> <p>This is also convenient because a common assumption in finance is that the logarithmic returns of a stock are independent and normally distributed with mean \(\mu\) and variance \(\sigma^2\). Note that for small returns, simple returns \(R_t\) approximate logarthmic returns \(r_t\) since \(r_t = \ln{(1 + R_t)} \approx R_t\), so the difference between the two returns is not substantial, and thus one can assume both simple and logarathmic returns are normally distributed. Next, if the logarithmic returns are normally distributed, then this in turn implies the stock price is <em>lognormally</em> distributed. This has been observed empirically to some extent, although in real life stock prices tend to have “fatter tails” - meaning rare events happen more often than a normal distribution would predict. Here are the monthly returns for IBM stock showing this behaviour.</p> <p><img src="/assets/img/monte-carlo-stocks/IBM-returns.png" alt="IBM monthly returns" /></p> <p class="caption"> Monthly simple and logarithmic returns of IBM stock with fitted normal distributions. We observe more returns at the extremities of the distributions than the normal distribution would predict. We call these 'fat tails' or 'excess kurtosis'. This image has been taken from 'Analysis of Financial Time Series, 3rd Ed.' by Ruey S. Tsay. </p> <p>This model also works well because it only permits positive security prices. Securities tend to only have positive prices (although in some cases they can go negative - see the <a href="https://assets.weforum.org/editor/kE8TpkO7bzo3dLFWEh9UDvgqRuZPOmURhnh0FfwOVYc.png">oil crash of 2020</a>).</p> <p>So, we want a process that generates a series of normally distributed returns \(r_t\) - which invites Brownian motion as a natural choice.</p> <h1 id="brownian-motion">Brownian motion</h1> <p><a href="https://stats.libretexts.org/Bookshelves/Probability_Theory/Probability_Mathematical_Statistics_and_Stochastic_Processes_(Siegrist)/18%3A_Brownian_Motion/18.01%3A_Standard_Brownian_Motion">Brownian motion</a> describes the motion of a particle in a fluid or gas. Such a particle bounces around “randomly” within the fluid surrounding it. The path it creates appears quite noisy and random. It can essentially be considered a limiting form of the random walk where both the time between steps and the step length approach zero (with some caveats: namely, if the time step is \(t\), the step length must be \(\sqrt{t}\) - this produces a process whose variance scales exactly with time). Consider flipping a coin to determine whether to take a step forward or backward. Now let the time between steps approach zero. You would trace a path that looks like this:</p> <p><img src="/assets/img/monte-carlo-stocks/wiener-process-zoom.png" alt="1-D Brownian Motion" /></p> <p class="caption"> 1 dimensional [arithmetic] Brownian motion. Geometric Brownian motion is the exponential of this process. <a target="_blank" href="http://creativecommons.org/licenses/by-sa/3.0/" title="Creative Commons Attribution-Share Alike 3.0">CC BY-SA 3.0</a>, <a target="_blank" href="https://commons.wikimedia.org/w/index.php?curid=1426987">Source</a> </p> <p>Brownian motion has the very nice property that the trajectories are normally distributed, which is exactly what we are looking for. We can simulate a Brownian process with discrete steps by sampling from a normal distribution (although if you only cared about the terminal value of a time series, you could sample from any distribution with unit variance; due to the central limit theorem the sum of random variables would approach a Gaussian distribution in the long term anyway).</p> <p>Hence, Brownian motion provides us with the series of normally distributed logarathmic returns \(r_t\) as required in \(\eqref{eq:rr}\):</p> <div style="width: 100%; overflow-x: auto;"> $$ \begin{align} r(t) = (\mu-\frac{\sigma^2}{2})t + \sigma B(t) \tag{2} \label{eq:bm} \end{align} $$ </div> <p>Taking the exponential of this process, we’ve recovered an equation for modelling stock price movement.</p> <p>Of particular interest here is the drift rate \(\mu - \frac{\sigma^2}{2}\) which causes the process to drift linearly, as the name suggests. \(\mu\) is obvious - it’s the mean continuosly compounding return for the stock, and in the absence of noise (or volatility), the stock price would only grow (or decrease) by this compounding amount. But what about \(\frac{\sigma^2}{2}\)? Well, it turns out that the expected value of a lognormally distributed variable is \(\exp(\mu + \sigma^2/2)\). Since the stock price is <em>lognormally distributed</em> (while returns are <em>normally distributed</em>), and since we require that the expected value of the stock price after continuous compounding to be \(S(0)\exp(\mu t)\), we must apply the correction term of \(- \frac{\sigma^2}{2}\) to the process.</p> <p>There’s also a philsophical argument to be made for choosing Brownian motion as the basis for this model. A common assumption made in finance is that markets are efficient, so there should be no arbitrage opportunities. Hence, the market should be unpredictable - if an actor could predict it, that would be an arbitrage opportunity that would be exploited away. Hence, random noise (which is what Brownian motion is, essentially) is a good choice for modelling markets.</p> <h1 id="option-pricing">Option Pricing</h1> <p>Monte-Carlo simulation is a statistical technique inspired by the casinos of Monaco. Much like gamblers resigning their fates to probability, we hand over the results of statistical analysis to chance. By running enough trials, we can make conclusions with statistical significance.</p> <p>Consider evaluating a call option with a strike prices of $105 for this stock. What would be the expected value of the option at expiry, given a geometric Brownian model for the stock’s movement? We can estimate this by generating a series of price paths, each of which can be considered a trial. The terminal value of each trial is related to the intrinsic value of the option via the relation \(V = \max(0, S - K)\) where \(S\) is the stock price and \(K\) is the strike price. The mean terminal value provides us with an estimate of the option’s value at expiry, while the standard deviation of terminal values provides us with a measure of how certain we are that the option will expire close to this value.</p> <div id="plot-1"></div> <p><button class="regenerate-button" onclick="regenerate1()">Regenerate</button></p> <div id="mean-1">0</div> <div id="sigma-1">0</div> <div id="option-mean-1">0</div> <p>We can increase the number of trials to increase the statistical certainty of the estimate. Re-running the simulation (by clicking “Regenerate”) on a large number of trials (below) yields a much smaller discrepency between experiments than on a small number of trials (above).</p> <div id="plot-2"></div> <p><button class="regenerate-button" onclick="regenerate2()">Regenerate</button></p> <div id="mean-2">0</div> <div id="sigma-2">0</div> <div id="option-mean-2">0</div> <h1 id="more-advanced-scenarios">More Advanced Scenarios</h1> <p>Monte-Carlo simulation of terminal values is a relatively simple simulation, and one that is not too useful as this analysis can probably be completed analytically. The true power of Monte-Carlo simulation is unlocked when analysing scenarios that are more difficult to solve analytically, if not impossible. For example, if we wanted to analyse an American-style option, which can be exercised anytime, we might want to count the probability of a stock price exceeding the strike price at any time during the lifetime of that option. We could do this by counting how many trials cross the strike price boundry, which is easy to do with a Monte-Carlo simulation.</p> <script src="https://cdn.plot.ly/plotly-2.4.2.min.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/9.5.1/math.js" integrity="sha512-AfRcJIj922x/jSJpQLnry0DYIBg6EGCtwk/MiQ6QvDlzb7kNFxH8EdqXLkaXXY3YHQS9FrSb8H7LzuLn0CZQ1A==" crossorigin="anonymous" referrerpolicy="no-referrer"></script> <script src="/assets/js/monte-carlo-options.js" async=""></script> </article> <div class="page-navigation code"> <a class="next" href="https://blog.skz.dev/blackbox-optimization-with-vizier" title="NEXT: Blackbox Optimization and Hyperparameter Tuning With Google's Vizier">&lt;&lt;</a> <span> &middot; </span> <a class="home" href="https://blog.skz.dev/" title="Back to Index">Index</a> <span> &middot; </span> <a class="prev" href="https://blog.skz.dev/gradient-descent" title="PREV: Interactive Gradient Descent Demo">&gt;&gt;</a> </div> </div> <div class="footer"> <span class="block">&copy; 2026 Sasha Kuznetsov</span> <!-- <span class="block"><small>&lt;/&gt; Powered by <a href="https://jekyllrb.com/">Jekyll</a> and <a href="https://github.com/heiswayi/the-plain">The Plain theme</a>.</small></span> --> </div> <script async defer src="https://api.skz.dev/latest.js"></script> <noscript><img src="https://api.skz.dev/noscript.gif" alt="" referrerpolicy="no-referrer-when-downgrade" /></noscript> <!-- <script async defer data-domain="blog.skz.dev" src="https://a-api.skz.dev/js/index.js"></script> --> </body> </html>
